(window["webpackJsonp"] = window["webpackJsonp"] || []).push([["vendor.aurelia-templating-router~be592036"],{

/***/ "aurelia-templating-router":
/*!*************************************************************************************************!*\
  !*** ./node_modules/aurelia-templating-router/dist/native-modules/aurelia-templating-router.js ***!
  \*************************************************************************************************/
/*! exports provided: RouteHref, RouterView, TemplatingRouteLoader, configure */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* WEBPACK VAR INJECTION */(function(Promise) {/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"RouteHref\", function() { return RouteHref; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"RouterView\", function() { return RouterView; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"TemplatingRouteLoader\", function() { return TemplatingRouteLoader; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"configure\", function() { return configure; });\n/* harmony import */ var aurelia_router__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! aurelia-router */ \"4ysu\");\n/* harmony import */ var aurelia_metadata__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! aurelia-metadata */ \"qrcG\");\n/* harmony import */ var aurelia_path__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! aurelia-path */ \"iD3O\");\n/* harmony import */ var aurelia_templating__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! aurelia-templating */ \"hij8\");\n/* harmony import */ var aurelia_dependency_injection__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! aurelia-dependency-injection */ \"3U8n\");\n/* harmony import */ var aurelia_binding__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! aurelia-binding */ \"X5gX\");\n/* harmony import */ var aurelia_pal__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! aurelia-pal */ \"70NS\");\n/* harmony import */ var aurelia_logging__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! aurelia-logging */ \"MP1E\");\n\n\n\n\n\n\n\n\n\n/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nfunction __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\n\nvar EmptyLayoutViewModel = /** @class */ (function () {\r\n    function EmptyLayoutViewModel() {\r\n    }\r\n    return EmptyLayoutViewModel;\r\n}());\r\n/**\r\n * Implementation of Aurelia Router ViewPort. Responsible for loading route, composing and swapping routes views\r\n */\r\nvar RouterView = /** @class */ (function () {\r\n    function RouterView(element, container, viewSlot, router, viewLocator, compositionTransaction, compositionEngine) {\r\n        this.element = element;\r\n        this.container = container;\r\n        this.viewSlot = viewSlot;\r\n        this.router = router;\r\n        this.viewLocator = viewLocator;\r\n        this.compositionTransaction = compositionTransaction;\r\n        this.compositionEngine = compositionEngine;\r\n        // add this <router-view/> to router view ports lookup based on name attribute\r\n        // when this router is the root router-view\r\n        // also trigger AppRouter registerViewPort extra flow\r\n        this.router.registerViewPort(this, this.element.getAttribute('name'));\r\n        // Each <router-view/> process its instruction as a composition transaction\r\n        // there are differences between intial composition and subsequent compositions\r\n        // also there are differences between root composition and child <router-view/> composition\r\n        // mark the first composition transaction with a property initialComposition to distinguish it\r\n        // when the root <router-view/> gets new instruction for the first time\r\n        if (!('initialComposition' in compositionTransaction)) {\r\n            compositionTransaction.initialComposition = true;\r\n            this.compositionTransactionNotifier = compositionTransaction.enlist();\r\n        }\r\n    }\r\n    /**@internal */\r\n    RouterView.inject = function () {\r\n        return [aurelia_pal__WEBPACK_IMPORTED_MODULE_6__[\"DOM\"].Element, aurelia_dependency_injection__WEBPACK_IMPORTED_MODULE_4__[\"Container\"], aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"ViewSlot\"], aurelia_router__WEBPACK_IMPORTED_MODULE_0__[\"Router\"], aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"ViewLocator\"], aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"CompositionTransaction\"], aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"CompositionEngine\"]];\r\n    };\r\n    RouterView.prototype.created = function (owningView) {\r\n        this.owningView = owningView;\r\n    };\r\n    RouterView.prototype.bind = function (bindingContext, overrideContext) {\r\n        // router needs to get access to view model of current route parent\r\n        // doing it in generic way via viewModel property on container\r\n        this.container.viewModel = bindingContext;\r\n        this.overrideContext = overrideContext;\r\n    };\r\n    /**\r\n     * Implementation of `aurelia-router` ViewPort interface, responsible for templating related part in routing Pipeline\r\n     */\r\n    RouterView.prototype.process = function ($viewPortInstruction, waitToSwap) {\r\n        var _this = this;\r\n        // have strong typings without exposing it in public typings, this is to ensure maximum backward compat\r\n        var viewPortInstruction = $viewPortInstruction;\r\n        var component = viewPortInstruction.component;\r\n        var childContainer = component.childContainer;\r\n        var viewModel = component.viewModel;\r\n        var viewModelResource = component.viewModelResource;\r\n        var metadata = viewModelResource.metadata;\r\n        var config = component.router.currentInstruction.config;\r\n        var viewPortConfig = config.viewPorts ? (config.viewPorts[viewPortInstruction.name] || {}) : {};\r\n        childContainer.get(RouterViewLocator)._notify(this);\r\n        // layoutInstruction is our layout viewModel\r\n        var layoutInstruction = {\r\n            viewModel: viewPortConfig.layoutViewModel || config.layoutViewModel || this.layoutViewModel,\r\n            view: viewPortConfig.layoutView || config.layoutView || this.layoutView,\r\n            model: viewPortConfig.layoutModel || config.layoutModel || this.layoutModel,\r\n            router: viewPortInstruction.component.router,\r\n            childContainer: childContainer,\r\n            viewSlot: this.viewSlot\r\n        };\r\n        // viewport will be a thin wrapper around composition engine\r\n        // to process instruction/configuration from users\r\n        // preparing all information related to a composition process\r\n        // first by getting view strategy of a ViewPortComponent View\r\n        var viewStrategy = this.viewLocator.getViewStrategy(component.view || viewModel);\r\n        if (viewStrategy && component.view) {\r\n            viewStrategy.makeRelativeTo(aurelia_metadata__WEBPACK_IMPORTED_MODULE_1__[\"Origin\"].get(component.router.container.viewModel.constructor).moduleId);\r\n        }\r\n        // using metadata of a custom element view model to load appropriate view-factory instance\r\n        return metadata\r\n            .load(childContainer, viewModelResource.value, null, viewStrategy, true)\r\n            // for custom element, viewFactory typing is always ViewFactory\r\n            // for custom attribute, it will be HtmlBehaviorResource\r\n            .then(function (viewFactory) {\r\n            // if this is not the first time that this <router-view/> is composing its instruction\r\n            // try to capture ownership of the composition transaction\r\n            // child <router-view/> will not be able to capture, since root <router-view/> typically captures\r\n            // the ownership token\r\n            if (!_this.compositionTransactionNotifier) {\r\n                _this.compositionTransactionOwnershipToken = _this.compositionTransaction.tryCapture();\r\n            }\r\n            if (layoutInstruction.viewModel || layoutInstruction.view) {\r\n                viewPortInstruction.layoutInstruction = layoutInstruction;\r\n            }\r\n            var viewPortComponentBehaviorInstruction = aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"BehaviorInstruction\"].dynamic(_this.element, viewModel, viewFactory);\r\n            viewPortInstruction.controller = metadata.create(childContainer, viewPortComponentBehaviorInstruction);\r\n            if (waitToSwap) {\r\n                return null;\r\n            }\r\n            _this.swap(viewPortInstruction);\r\n        });\r\n    };\r\n    RouterView.prototype.swap = function ($viewPortInstruction) {\r\n        var _this = this;\r\n        // have strong typings without exposing it in public typings, this is to ensure maximum backward compat\r\n        var viewPortInstruction = $viewPortInstruction;\r\n        var viewPortController = viewPortInstruction.controller;\r\n        var layoutInstruction = viewPortInstruction.layoutInstruction;\r\n        var previousView = this.view;\r\n        // Final step of swapping a <router-view/> ViewPortComponent\r\n        var work = function () {\r\n            var swapStrategy = aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"SwapStrategies\"][_this.swapOrder] || aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"SwapStrategies\"].after;\r\n            var viewSlot = _this.viewSlot;\r\n            swapStrategy(viewSlot, previousView, function () { return Promise.resolve(viewSlot.add(_this.view)); }).then(function () {\r\n                _this._notify();\r\n            });\r\n        };\r\n        // Ensure all users setups have been completed\r\n        var ready = function (owningView_or_layoutView) {\r\n            viewPortController.automate(_this.overrideContext, owningView_or_layoutView);\r\n            var transactionOwnerShipToken = _this.compositionTransactionOwnershipToken;\r\n            // if this router-view is the root <router-view/> of a normal startup via aurelia.setRoot\r\n            // attemp to take control of the transaction\r\n            // if ownership can be taken\r\n            // wait for transaction to complete before swapping\r\n            if (transactionOwnerShipToken) {\r\n                return transactionOwnerShipToken\r\n                    .waitForCompositionComplete()\r\n                    .then(function () {\r\n                    _this.compositionTransactionOwnershipToken = null;\r\n                    return work();\r\n                });\r\n            }\r\n            // otherwise, just swap\r\n            return work();\r\n        };\r\n        // If there is layout instruction, new to compose layout before processing ViewPortComponent\r\n        // layout controller/view/view-model is composed using composition engine APIs\r\n        if (layoutInstruction) {\r\n            if (!layoutInstruction.viewModel) {\r\n                // createController chokes if there's no viewmodel, so create a dummy one\r\n                // but avoid using a POJO as it creates unwanted metadata in Object constructor\r\n                layoutInstruction.viewModel = new EmptyLayoutViewModel();\r\n            }\r\n            // using composition engine to create compose layout\r\n            return this.compositionEngine\r\n                // first create controller from layoutInstruction\r\n                // and treat it as CompositionContext\r\n                // then emulate slot projection with ViewPortComponent view\r\n                .createController(layoutInstruction)\r\n                .then(function (layoutController) {\r\n                var layoutView = layoutController.view;\r\n                aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"ShadowDOM\"].distributeView(viewPortController.view, layoutController.slots || layoutView.slots);\r\n                // when there is a layout\r\n                // view hierarchy is: <router-view/> owner view -> layout view -> ViewPortComponent view\r\n                layoutController.automate(Object(aurelia_binding__WEBPACK_IMPORTED_MODULE_5__[\"createOverrideContext\"])(layoutInstruction.viewModel), _this.owningView);\r\n                layoutView.children.push(viewPortController.view);\r\n                return layoutView || layoutController;\r\n            })\r\n                .then(function (newView) {\r\n                _this.view = newView;\r\n                return ready(newView);\r\n            });\r\n        }\r\n        // if there is no layout, then get ViewPortComponent view ready as view property\r\n        // and process controller/swapping\r\n        // when there is no layout\r\n        // view hierarchy is: <router-view/> owner view -> ViewPortComponent view\r\n        this.view = viewPortController.view;\r\n        return ready(this.owningView);\r\n    };\r\n    /**\r\n     * Notify composition transaction that this router has finished processing\r\n     * Happens when this <router-view/> is the root router-view\r\n     * @internal\r\n     */\r\n    RouterView.prototype._notify = function () {\r\n        var notifier = this.compositionTransactionNotifier;\r\n        if (notifier) {\r\n            notifier.done();\r\n            this.compositionTransactionNotifier = null;\r\n        }\r\n    };\r\n    /**\r\n     * @internal Actively avoid using decorator to reduce the amount of code generated\r\n     *\r\n     * There is no view to compose by default in a router view\r\n     * This custom element is responsible for composing its own view, based on current config\r\n     */\r\n    RouterView.$view = null;\r\n    /**\r\n     * @internal Actively avoid using decorator to reduce the amount of code generated\r\n     */\r\n    RouterView.$resource = {\r\n        name: 'router-view',\r\n        bindables: ['swapOrder', 'layoutView', 'layoutViewModel', 'layoutModel', 'inherit-binding-context']\r\n    };\r\n    return RouterView;\r\n}());\r\n/**\r\n* Locator which finds the nearest RouterView, relative to the current dependency injection container.\r\n*/\r\nvar RouterViewLocator = /** @class */ (function () {\r\n    /**\r\n    * Creates an instance of the RouterViewLocator class.\r\n    */\r\n    function RouterViewLocator() {\r\n        var _this = this;\r\n        this.promise = new Promise(function (resolve) { return _this.resolve = resolve; });\r\n    }\r\n    /**\r\n    * Finds the nearest RouterView instance.\r\n    * @returns A promise that will be resolved with the located RouterView instance.\r\n    */\r\n    RouterViewLocator.prototype.findNearest = function () {\r\n        return this.promise;\r\n    };\r\n    /**@internal */\r\n    RouterViewLocator.prototype._notify = function (routerView) {\r\n        this.resolve(routerView);\r\n    };\r\n    return RouterViewLocator;\r\n}());\n\n/**@internal exported for unit testing */\r\nvar EmptyClass = /** @class */ (function () {\r\n    function EmptyClass() {\r\n    }\r\n    return EmptyClass;\r\n}());\r\naurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"inlineView\"]('<template></template>')(EmptyClass);\r\n/**\r\n * Default implementation of `RouteLoader` used for loading component based on a route config\r\n */\r\nvar TemplatingRouteLoader = /** @class */ (function (_super) {\r\n    __extends(TemplatingRouteLoader, _super);\r\n    function TemplatingRouteLoader(compositionEngine) {\r\n        var _this = _super.call(this) || this;\r\n        _this.compositionEngine = compositionEngine;\r\n        return _this;\r\n    }\r\n    /**\r\n     * Resolve a view model from a RouteConfig\r\n     * Throws when there is neither \"moduleId\" nor \"viewModel\" property\r\n     * @internal\r\n     */\r\n    TemplatingRouteLoader.prototype.resolveViewModel = function (router, config) {\r\n        return new Promise(function (resolve, reject) {\r\n            var viewModel;\r\n            if ('moduleId' in config) {\r\n                var moduleId = config.moduleId;\r\n                if (moduleId === null) {\r\n                    viewModel = EmptyClass;\r\n                }\r\n                else {\r\n                    // this requires container of router has passes a certain point\r\n                    // where a view model has been setup on the container\r\n                    // it will fail in enhance scenario because no viewport has been registered\r\n                    moduleId = Object(aurelia_path__WEBPACK_IMPORTED_MODULE_2__[\"relativeToFile\"])(moduleId, aurelia_metadata__WEBPACK_IMPORTED_MODULE_1__[\"Origin\"].get(router.container.viewModel.constructor).moduleId);\r\n                    if (/\\.html/i.test(moduleId)) {\r\n                        viewModel = createDynamicClass(moduleId);\r\n                    }\r\n                    else {\r\n                        viewModel = moduleId;\r\n                    }\r\n                }\r\n                return resolve(viewModel);\r\n            }\r\n            // todo: add if ('viewModel' in config) to support static view model resolution\r\n            reject(new Error('Invalid route config. No \"moduleId\" found.'));\r\n        });\r\n    };\r\n    /**\r\n     * Create child container based on a router container\r\n     * Also ensures that child router are properly constructed in the newly created child container\r\n     * @internal\r\n     */\r\n    TemplatingRouteLoader.prototype.createChildContainer = function (router) {\r\n        var childContainer = router.container.createChild();\r\n        childContainer.registerSingleton(RouterViewLocator);\r\n        childContainer.getChildRouter = function () {\r\n            var childRouter;\r\n            childContainer.registerHandler(aurelia_router__WEBPACK_IMPORTED_MODULE_0__[\"Router\"], function () { return childRouter || (childRouter = router.createChild(childContainer)); });\r\n            return childContainer.get(aurelia_router__WEBPACK_IMPORTED_MODULE_0__[\"Router\"]);\r\n        };\r\n        return childContainer;\r\n    };\r\n    /**\r\n     * Load corresponding component of a route config of a navigation instruction\r\n     */\r\n    TemplatingRouteLoader.prototype.loadRoute = function (router, config, _navInstruction) {\r\n        var _this = this;\r\n        return this\r\n            .resolveViewModel(router, config)\r\n            .then(function (viewModel) { return _this.compositionEngine.ensureViewModel({\r\n            viewModel: viewModel,\r\n            childContainer: _this.createChildContainer(router),\r\n            view: config.view || config.viewStrategy,\r\n            router: router\r\n        }); });\r\n    };\r\n    /**@internal */\r\n    TemplatingRouteLoader.inject = [aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"CompositionEngine\"]];\r\n    return TemplatingRouteLoader;\r\n}(aurelia_router__WEBPACK_IMPORTED_MODULE_0__[\"RouteLoader\"]));\r\n/**@internal exported for unit testing */\r\nfunction createDynamicClass(moduleId) {\r\n    var name = /([^\\/^\\?]+)\\.html/i.exec(moduleId)[1];\r\n    var DynamicClass = /** @class */ (function () {\r\n        function DynamicClass() {\r\n        }\r\n        DynamicClass.prototype.bind = function (bindingContext) {\r\n            this.$parent = bindingContext;\r\n        };\r\n        return DynamicClass;\r\n    }());\r\n    Object(aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"customElement\"])(name)(DynamicClass);\r\n    Object(aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"useView\"])(moduleId)(DynamicClass);\r\n    return DynamicClass;\r\n}\n\nvar logger = Object(aurelia_logging__WEBPACK_IMPORTED_MODULE_7__[\"getLogger\"])('route-href');\r\n/**\r\n * Helper custom attribute to help associate an element with a route by name\r\n */\r\nvar RouteHref = /** @class */ (function () {\r\n    function RouteHref(router, element) {\r\n        this.router = router;\r\n        this.element = element;\r\n        this.attribute = 'href';\r\n    }\r\n    /*@internal */\r\n    RouteHref.inject = function () {\r\n        return [aurelia_router__WEBPACK_IMPORTED_MODULE_0__[\"Router\"], aurelia_pal__WEBPACK_IMPORTED_MODULE_6__[\"DOM\"].Element];\r\n    };\r\n    RouteHref.prototype.bind = function () {\r\n        this.isActive = true;\r\n        this.processChange();\r\n    };\r\n    RouteHref.prototype.unbind = function () {\r\n        this.isActive = false;\r\n    };\r\n    RouteHref.prototype.attributeChanged = function (value, previous) {\r\n        if (previous) {\r\n            this.element.removeAttribute(previous);\r\n        }\r\n        return this.processChange();\r\n    };\r\n    RouteHref.prototype.processChange = function () {\r\n        var _this = this;\r\n        return this.router\r\n            .ensureConfigured()\r\n            .then(function () {\r\n            if (!_this.isActive) {\r\n                // returning null to avoid Bluebird warning\r\n                return null;\r\n            }\r\n            var element = _this.element;\r\n            var href = _this.router.generate(_this.route, _this.params);\r\n            if (element.au.controller) {\r\n                element.au.controller.viewModel[_this.attribute] = href;\r\n            }\r\n            else {\r\n                element.setAttribute(_this.attribute, href);\r\n            }\r\n            // returning null to avoid Bluebird warning\r\n            return null;\r\n        })\r\n            .catch(function (reason) {\r\n            logger.error(reason);\r\n        });\r\n    };\r\n    /**\r\n     * @internal Actively avoid using decorator to reduce the amount of code generated\r\n     */\r\n    RouteHref.$resource = {\r\n        type: 'attribute',\r\n        name: 'route-href',\r\n        bindables: [\r\n            { name: 'route', changeHandler: 'processChange', primaryProperty: true },\r\n            { name: 'params', changeHandler: 'processChange' },\r\n            'attribute'\r\n        ] // type definition of Aurelia templating is wrong\r\n    };\r\n    return RouteHref;\r\n}());\n\nfunction configure(config) {\r\n    config\r\n        .singleton(aurelia_router__WEBPACK_IMPORTED_MODULE_0__[\"RouteLoader\"], TemplatingRouteLoader)\r\n        .singleton(aurelia_router__WEBPACK_IMPORTED_MODULE_0__[\"Router\"], aurelia_router__WEBPACK_IMPORTED_MODULE_0__[\"AppRouter\"])\r\n        .globalResources(RouterView, RouteHref);\r\n    config.container.registerAlias(aurelia_router__WEBPACK_IMPORTED_MODULE_0__[\"Router\"], aurelia_router__WEBPACK_IMPORTED_MODULE_0__[\"AppRouter\"]);\r\n}\n\n\n//# sourceMappingURL=aurelia-templating-router.js.map\n\n/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(/*! promise-polyfill */ \"B/eG\")[\"default\"]))//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXVyZWxpYS10ZW1wbGF0aW5nLXJvdXRlci5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9hdXJlbGlhLXRlbXBsYXRpbmctcm91dGVyL2Rpc3QvbmF0aXZlLW1vZHVsZXMvYXVyZWxpYS10ZW1wbGF0aW5nLXJvdXRlci5qcz9hYjMwIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFJvdXRlciwgUm91dGVMb2FkZXIsIEFwcFJvdXRlciB9IGZyb20gJ2F1cmVsaWEtcm91dGVyJztcbmltcG9ydCB7IE9yaWdpbiB9IGZyb20gJ2F1cmVsaWEtbWV0YWRhdGEnO1xuaW1wb3J0IHsgcmVsYXRpdmVUb0ZpbGUgfSBmcm9tICdhdXJlbGlhLXBhdGgnO1xuaW1wb3J0IHsgQmVoYXZpb3JJbnN0cnVjdGlvbiwgU2hhZG93RE9NLCBWaWV3U2xvdCwgVmlld0xvY2F0b3IsIENvbXBvc2l0aW9uVHJhbnNhY3Rpb24sIENvbXBvc2l0aW9uRW5naW5lLCBTd2FwU3RyYXRlZ2llcywgaW5saW5lVmlldywgY3VzdG9tRWxlbWVudCwgdXNlVmlldyB9IGZyb20gJ2F1cmVsaWEtdGVtcGxhdGluZyc7XG5pbXBvcnQgeyBDb250YWluZXIgfSBmcm9tICdhdXJlbGlhLWRlcGVuZGVuY3ktaW5qZWN0aW9uJztcbmltcG9ydCB7IGNyZWF0ZU92ZXJyaWRlQ29udGV4dCB9IGZyb20gJ2F1cmVsaWEtYmluZGluZyc7XG5pbXBvcnQgeyBET00gfSBmcm9tICdhdXJlbGlhLXBhbCc7XG5pbXBvcnQgeyBnZXRMb2dnZXIgfSBmcm9tICdhdXJlbGlhLWxvZ2dpbmcnO1xuXG4vKiEgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcclxuQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXHJcbkxpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7IHlvdSBtYXkgbm90IHVzZVxyXG50aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4gWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZVxyXG5MaWNlbnNlIGF0IGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG5cclxuVEhJUyBDT0RFIElTIFBST1ZJREVEIE9OIEFOICpBUyBJUyogQkFTSVMsIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWVxyXG5LSU5ELCBFSVRIRVIgRVhQUkVTUyBPUiBJTVBMSUVELCBJTkNMVURJTkcgV0lUSE9VVCBMSU1JVEFUSU9OIEFOWSBJTVBMSUVEXHJcbldBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBUSVRMRSwgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UsXHJcbk1FUkNIQU5UQUJMSVRZIE9SIE5PTi1JTkZSSU5HRU1FTlQuXHJcblxyXG5TZWUgdGhlIEFwYWNoZSBWZXJzaW9uIDIuMCBMaWNlbnNlIGZvciBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnNcclxuYW5kIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiAqL1xyXG4vKiBnbG9iYWwgUmVmbGVjdCwgUHJvbWlzZSAqL1xyXG5cclxudmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbihkLCBiKSB7XHJcbiAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8XHJcbiAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fFxyXG4gICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdOyB9O1xyXG4gICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7XHJcbn07XHJcblxyXG5mdW5jdGlvbiBfX2V4dGVuZHMoZCwgYikge1xyXG4gICAgZXh0ZW5kU3RhdGljcyhkLCBiKTtcclxuICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfVxyXG4gICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpO1xyXG59XG5cbnZhciBFbXB0eUxheW91dFZpZXdNb2RlbCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIEVtcHR5TGF5b3V0Vmlld01vZGVsKCkge1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIEVtcHR5TGF5b3V0Vmlld01vZGVsO1xyXG59KCkpO1xyXG4vKipcclxuICogSW1wbGVtZW50YXRpb24gb2YgQXVyZWxpYSBSb3V0ZXIgVmlld1BvcnQuIFJlc3BvbnNpYmxlIGZvciBsb2FkaW5nIHJvdXRlLCBjb21wb3NpbmcgYW5kIHN3YXBwaW5nIHJvdXRlcyB2aWV3c1xyXG4gKi9cclxudmFyIFJvdXRlclZpZXcgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBSb3V0ZXJWaWV3KGVsZW1lbnQsIGNvbnRhaW5lciwgdmlld1Nsb3QsIHJvdXRlciwgdmlld0xvY2F0b3IsIGNvbXBvc2l0aW9uVHJhbnNhY3Rpb24sIGNvbXBvc2l0aW9uRW5naW5lKSB7XHJcbiAgICAgICAgdGhpcy5lbGVtZW50ID0gZWxlbWVudDtcclxuICAgICAgICB0aGlzLmNvbnRhaW5lciA9IGNvbnRhaW5lcjtcclxuICAgICAgICB0aGlzLnZpZXdTbG90ID0gdmlld1Nsb3Q7XHJcbiAgICAgICAgdGhpcy5yb3V0ZXIgPSByb3V0ZXI7XHJcbiAgICAgICAgdGhpcy52aWV3TG9jYXRvciA9IHZpZXdMb2NhdG9yO1xyXG4gICAgICAgIHRoaXMuY29tcG9zaXRpb25UcmFuc2FjdGlvbiA9IGNvbXBvc2l0aW9uVHJhbnNhY3Rpb247XHJcbiAgICAgICAgdGhpcy5jb21wb3NpdGlvbkVuZ2luZSA9IGNvbXBvc2l0aW9uRW5naW5lO1xyXG4gICAgICAgIC8vIGFkZCB0aGlzIDxyb3V0ZXItdmlldy8+IHRvIHJvdXRlciB2aWV3IHBvcnRzIGxvb2t1cCBiYXNlZCBvbiBuYW1lIGF0dHJpYnV0ZVxyXG4gICAgICAgIC8vIHdoZW4gdGhpcyByb3V0ZXIgaXMgdGhlIHJvb3Qgcm91dGVyLXZpZXdcclxuICAgICAgICAvLyBhbHNvIHRyaWdnZXIgQXBwUm91dGVyIHJlZ2lzdGVyVmlld1BvcnQgZXh0cmEgZmxvd1xyXG4gICAgICAgIHRoaXMucm91dGVyLnJlZ2lzdGVyVmlld1BvcnQodGhpcywgdGhpcy5lbGVtZW50LmdldEF0dHJpYnV0ZSgnbmFtZScpKTtcclxuICAgICAgICAvLyBFYWNoIDxyb3V0ZXItdmlldy8+IHByb2Nlc3MgaXRzIGluc3RydWN0aW9uIGFzIGEgY29tcG9zaXRpb24gdHJhbnNhY3Rpb25cclxuICAgICAgICAvLyB0aGVyZSBhcmUgZGlmZmVyZW5jZXMgYmV0d2VlbiBpbnRpYWwgY29tcG9zaXRpb24gYW5kIHN1YnNlcXVlbnQgY29tcG9zaXRpb25zXHJcbiAgICAgICAgLy8gYWxzbyB0aGVyZSBhcmUgZGlmZmVyZW5jZXMgYmV0d2VlbiByb290IGNvbXBvc2l0aW9uIGFuZCBjaGlsZCA8cm91dGVyLXZpZXcvPiBjb21wb3NpdGlvblxyXG4gICAgICAgIC8vIG1hcmsgdGhlIGZpcnN0IGNvbXBvc2l0aW9uIHRyYW5zYWN0aW9uIHdpdGggYSBwcm9wZXJ0eSBpbml0aWFsQ29tcG9zaXRpb24gdG8gZGlzdGluZ3Vpc2ggaXRcclxuICAgICAgICAvLyB3aGVuIHRoZSByb290IDxyb3V0ZXItdmlldy8+IGdldHMgbmV3IGluc3RydWN0aW9uIGZvciB0aGUgZmlyc3QgdGltZVxyXG4gICAgICAgIGlmICghKCdpbml0aWFsQ29tcG9zaXRpb24nIGluIGNvbXBvc2l0aW9uVHJhbnNhY3Rpb24pKSB7XHJcbiAgICAgICAgICAgIGNvbXBvc2l0aW9uVHJhbnNhY3Rpb24uaW5pdGlhbENvbXBvc2l0aW9uID0gdHJ1ZTtcclxuICAgICAgICAgICAgdGhpcy5jb21wb3NpdGlvblRyYW5zYWN0aW9uTm90aWZpZXIgPSBjb21wb3NpdGlvblRyYW5zYWN0aW9uLmVubGlzdCgpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIC8qKkBpbnRlcm5hbCAqL1xyXG4gICAgUm91dGVyVmlldy5pbmplY3QgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIFtET00uRWxlbWVudCwgQ29udGFpbmVyLCBWaWV3U2xvdCwgUm91dGVyLCBWaWV3TG9jYXRvciwgQ29tcG9zaXRpb25UcmFuc2FjdGlvbiwgQ29tcG9zaXRpb25FbmdpbmVdO1xyXG4gICAgfTtcclxuICAgIFJvdXRlclZpZXcucHJvdG90eXBlLmNyZWF0ZWQgPSBmdW5jdGlvbiAob3duaW5nVmlldykge1xyXG4gICAgICAgIHRoaXMub3duaW5nVmlldyA9IG93bmluZ1ZpZXc7XHJcbiAgICB9O1xyXG4gICAgUm91dGVyVmlldy5wcm90b3R5cGUuYmluZCA9IGZ1bmN0aW9uIChiaW5kaW5nQ29udGV4dCwgb3ZlcnJpZGVDb250ZXh0KSB7XHJcbiAgICAgICAgLy8gcm91dGVyIG5lZWRzIHRvIGdldCBhY2Nlc3MgdG8gdmlldyBtb2RlbCBvZiBjdXJyZW50IHJvdXRlIHBhcmVudFxyXG4gICAgICAgIC8vIGRvaW5nIGl0IGluIGdlbmVyaWMgd2F5IHZpYSB2aWV3TW9kZWwgcHJvcGVydHkgb24gY29udGFpbmVyXHJcbiAgICAgICAgdGhpcy5jb250YWluZXIudmlld01vZGVsID0gYmluZGluZ0NvbnRleHQ7XHJcbiAgICAgICAgdGhpcy5vdmVycmlkZUNvbnRleHQgPSBvdmVycmlkZUNvbnRleHQ7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBJbXBsZW1lbnRhdGlvbiBvZiBgYXVyZWxpYS1yb3V0ZXJgIFZpZXdQb3J0IGludGVyZmFjZSwgcmVzcG9uc2libGUgZm9yIHRlbXBsYXRpbmcgcmVsYXRlZCBwYXJ0IGluIHJvdXRpbmcgUGlwZWxpbmVcclxuICAgICAqL1xyXG4gICAgUm91dGVyVmlldy5wcm90b3R5cGUucHJvY2VzcyA9IGZ1bmN0aW9uICgkdmlld1BvcnRJbnN0cnVjdGlvbiwgd2FpdFRvU3dhcCkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgLy8gaGF2ZSBzdHJvbmcgdHlwaW5ncyB3aXRob3V0IGV4cG9zaW5nIGl0IGluIHB1YmxpYyB0eXBpbmdzLCB0aGlzIGlzIHRvIGVuc3VyZSBtYXhpbXVtIGJhY2t3YXJkIGNvbXBhdFxyXG4gICAgICAgIHZhciB2aWV3UG9ydEluc3RydWN0aW9uID0gJHZpZXdQb3J0SW5zdHJ1Y3Rpb247XHJcbiAgICAgICAgdmFyIGNvbXBvbmVudCA9IHZpZXdQb3J0SW5zdHJ1Y3Rpb24uY29tcG9uZW50O1xyXG4gICAgICAgIHZhciBjaGlsZENvbnRhaW5lciA9IGNvbXBvbmVudC5jaGlsZENvbnRhaW5lcjtcclxuICAgICAgICB2YXIgdmlld01vZGVsID0gY29tcG9uZW50LnZpZXdNb2RlbDtcclxuICAgICAgICB2YXIgdmlld01vZGVsUmVzb3VyY2UgPSBjb21wb25lbnQudmlld01vZGVsUmVzb3VyY2U7XHJcbiAgICAgICAgdmFyIG1ldGFkYXRhID0gdmlld01vZGVsUmVzb3VyY2UubWV0YWRhdGE7XHJcbiAgICAgICAgdmFyIGNvbmZpZyA9IGNvbXBvbmVudC5yb3V0ZXIuY3VycmVudEluc3RydWN0aW9uLmNvbmZpZztcclxuICAgICAgICB2YXIgdmlld1BvcnRDb25maWcgPSBjb25maWcudmlld1BvcnRzID8gKGNvbmZpZy52aWV3UG9ydHNbdmlld1BvcnRJbnN0cnVjdGlvbi5uYW1lXSB8fCB7fSkgOiB7fTtcclxuICAgICAgICBjaGlsZENvbnRhaW5lci5nZXQoUm91dGVyVmlld0xvY2F0b3IpLl9ub3RpZnkodGhpcyk7XHJcbiAgICAgICAgLy8gbGF5b3V0SW5zdHJ1Y3Rpb24gaXMgb3VyIGxheW91dCB2aWV3TW9kZWxcclxuICAgICAgICB2YXIgbGF5b3V0SW5zdHJ1Y3Rpb24gPSB7XHJcbiAgICAgICAgICAgIHZpZXdNb2RlbDogdmlld1BvcnRDb25maWcubGF5b3V0Vmlld01vZGVsIHx8IGNvbmZpZy5sYXlvdXRWaWV3TW9kZWwgfHwgdGhpcy5sYXlvdXRWaWV3TW9kZWwsXHJcbiAgICAgICAgICAgIHZpZXc6IHZpZXdQb3J0Q29uZmlnLmxheW91dFZpZXcgfHwgY29uZmlnLmxheW91dFZpZXcgfHwgdGhpcy5sYXlvdXRWaWV3LFxyXG4gICAgICAgICAgICBtb2RlbDogdmlld1BvcnRDb25maWcubGF5b3V0TW9kZWwgfHwgY29uZmlnLmxheW91dE1vZGVsIHx8IHRoaXMubGF5b3V0TW9kZWwsXHJcbiAgICAgICAgICAgIHJvdXRlcjogdmlld1BvcnRJbnN0cnVjdGlvbi5jb21wb25lbnQucm91dGVyLFxyXG4gICAgICAgICAgICBjaGlsZENvbnRhaW5lcjogY2hpbGRDb250YWluZXIsXHJcbiAgICAgICAgICAgIHZpZXdTbG90OiB0aGlzLnZpZXdTbG90XHJcbiAgICAgICAgfTtcclxuICAgICAgICAvLyB2aWV3cG9ydCB3aWxsIGJlIGEgdGhpbiB3cmFwcGVyIGFyb3VuZCBjb21wb3NpdGlvbiBlbmdpbmVcclxuICAgICAgICAvLyB0byBwcm9jZXNzIGluc3RydWN0aW9uL2NvbmZpZ3VyYXRpb24gZnJvbSB1c2Vyc1xyXG4gICAgICAgIC8vIHByZXBhcmluZyBhbGwgaW5mb3JtYXRpb24gcmVsYXRlZCB0byBhIGNvbXBvc2l0aW9uIHByb2Nlc3NcclxuICAgICAgICAvLyBmaXJzdCBieSBnZXR0aW5nIHZpZXcgc3RyYXRlZ3kgb2YgYSBWaWV3UG9ydENvbXBvbmVudCBWaWV3XHJcbiAgICAgICAgdmFyIHZpZXdTdHJhdGVneSA9IHRoaXMudmlld0xvY2F0b3IuZ2V0Vmlld1N0cmF0ZWd5KGNvbXBvbmVudC52aWV3IHx8IHZpZXdNb2RlbCk7XHJcbiAgICAgICAgaWYgKHZpZXdTdHJhdGVneSAmJiBjb21wb25lbnQudmlldykge1xyXG4gICAgICAgICAgICB2aWV3U3RyYXRlZ3kubWFrZVJlbGF0aXZlVG8oT3JpZ2luLmdldChjb21wb25lbnQucm91dGVyLmNvbnRhaW5lci52aWV3TW9kZWwuY29uc3RydWN0b3IpLm1vZHVsZUlkKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gdXNpbmcgbWV0YWRhdGEgb2YgYSBjdXN0b20gZWxlbWVudCB2aWV3IG1vZGVsIHRvIGxvYWQgYXBwcm9wcmlhdGUgdmlldy1mYWN0b3J5IGluc3RhbmNlXHJcbiAgICAgICAgcmV0dXJuIG1ldGFkYXRhXHJcbiAgICAgICAgICAgIC5sb2FkKGNoaWxkQ29udGFpbmVyLCB2aWV3TW9kZWxSZXNvdXJjZS52YWx1ZSwgbnVsbCwgdmlld1N0cmF0ZWd5LCB0cnVlKVxyXG4gICAgICAgICAgICAvLyBmb3IgY3VzdG9tIGVsZW1lbnQsIHZpZXdGYWN0b3J5IHR5cGluZyBpcyBhbHdheXMgVmlld0ZhY3RvcnlcclxuICAgICAgICAgICAgLy8gZm9yIGN1c3RvbSBhdHRyaWJ1dGUsIGl0IHdpbGwgYmUgSHRtbEJlaGF2aW9yUmVzb3VyY2VcclxuICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKHZpZXdGYWN0b3J5KSB7XHJcbiAgICAgICAgICAgIC8vIGlmIHRoaXMgaXMgbm90IHRoZSBmaXJzdCB0aW1lIHRoYXQgdGhpcyA8cm91dGVyLXZpZXcvPiBpcyBjb21wb3NpbmcgaXRzIGluc3RydWN0aW9uXHJcbiAgICAgICAgICAgIC8vIHRyeSB0byBjYXB0dXJlIG93bmVyc2hpcCBvZiB0aGUgY29tcG9zaXRpb24gdHJhbnNhY3Rpb25cclxuICAgICAgICAgICAgLy8gY2hpbGQgPHJvdXRlci12aWV3Lz4gd2lsbCBub3QgYmUgYWJsZSB0byBjYXB0dXJlLCBzaW5jZSByb290IDxyb3V0ZXItdmlldy8+IHR5cGljYWxseSBjYXB0dXJlc1xyXG4gICAgICAgICAgICAvLyB0aGUgb3duZXJzaGlwIHRva2VuXHJcbiAgICAgICAgICAgIGlmICghX3RoaXMuY29tcG9zaXRpb25UcmFuc2FjdGlvbk5vdGlmaWVyKSB7XHJcbiAgICAgICAgICAgICAgICBfdGhpcy5jb21wb3NpdGlvblRyYW5zYWN0aW9uT3duZXJzaGlwVG9rZW4gPSBfdGhpcy5jb21wb3NpdGlvblRyYW5zYWN0aW9uLnRyeUNhcHR1cmUoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAobGF5b3V0SW5zdHJ1Y3Rpb24udmlld01vZGVsIHx8IGxheW91dEluc3RydWN0aW9uLnZpZXcpIHtcclxuICAgICAgICAgICAgICAgIHZpZXdQb3J0SW5zdHJ1Y3Rpb24ubGF5b3V0SW5zdHJ1Y3Rpb24gPSBsYXlvdXRJbnN0cnVjdGlvbjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB2YXIgdmlld1BvcnRDb21wb25lbnRCZWhhdmlvckluc3RydWN0aW9uID0gQmVoYXZpb3JJbnN0cnVjdGlvbi5keW5hbWljKF90aGlzLmVsZW1lbnQsIHZpZXdNb2RlbCwgdmlld0ZhY3RvcnkpO1xyXG4gICAgICAgICAgICB2aWV3UG9ydEluc3RydWN0aW9uLmNvbnRyb2xsZXIgPSBtZXRhZGF0YS5jcmVhdGUoY2hpbGRDb250YWluZXIsIHZpZXdQb3J0Q29tcG9uZW50QmVoYXZpb3JJbnN0cnVjdGlvbik7XHJcbiAgICAgICAgICAgIGlmICh3YWl0VG9Td2FwKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBfdGhpcy5zd2FwKHZpZXdQb3J0SW5zdHJ1Y3Rpb24pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIFJvdXRlclZpZXcucHJvdG90eXBlLnN3YXAgPSBmdW5jdGlvbiAoJHZpZXdQb3J0SW5zdHJ1Y3Rpb24pIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIC8vIGhhdmUgc3Ryb25nIHR5cGluZ3Mgd2l0aG91dCBleHBvc2luZyBpdCBpbiBwdWJsaWMgdHlwaW5ncywgdGhpcyBpcyB0byBlbnN1cmUgbWF4aW11bSBiYWNrd2FyZCBjb21wYXRcclxuICAgICAgICB2YXIgdmlld1BvcnRJbnN0cnVjdGlvbiA9ICR2aWV3UG9ydEluc3RydWN0aW9uO1xyXG4gICAgICAgIHZhciB2aWV3UG9ydENvbnRyb2xsZXIgPSB2aWV3UG9ydEluc3RydWN0aW9uLmNvbnRyb2xsZXI7XHJcbiAgICAgICAgdmFyIGxheW91dEluc3RydWN0aW9uID0gdmlld1BvcnRJbnN0cnVjdGlvbi5sYXlvdXRJbnN0cnVjdGlvbjtcclxuICAgICAgICB2YXIgcHJldmlvdXNWaWV3ID0gdGhpcy52aWV3O1xyXG4gICAgICAgIC8vIEZpbmFsIHN0ZXAgb2Ygc3dhcHBpbmcgYSA8cm91dGVyLXZpZXcvPiBWaWV3UG9ydENvbXBvbmVudFxyXG4gICAgICAgIHZhciB3b3JrID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgc3dhcFN0cmF0ZWd5ID0gU3dhcFN0cmF0ZWdpZXNbX3RoaXMuc3dhcE9yZGVyXSB8fCBTd2FwU3RyYXRlZ2llcy5hZnRlcjtcclxuICAgICAgICAgICAgdmFyIHZpZXdTbG90ID0gX3RoaXMudmlld1Nsb3Q7XHJcbiAgICAgICAgICAgIHN3YXBTdHJhdGVneSh2aWV3U2xvdCwgcHJldmlvdXNWaWV3LCBmdW5jdGlvbiAoKSB7IHJldHVybiBQcm9taXNlLnJlc29sdmUodmlld1Nsb3QuYWRkKF90aGlzLnZpZXcpKTsgfSkudGhlbihmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICBfdGhpcy5fbm90aWZ5KCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgLy8gRW5zdXJlIGFsbCB1c2VycyBzZXR1cHMgaGF2ZSBiZWVuIGNvbXBsZXRlZFxyXG4gICAgICAgIHZhciByZWFkeSA9IGZ1bmN0aW9uIChvd25pbmdWaWV3X29yX2xheW91dFZpZXcpIHtcclxuICAgICAgICAgICAgdmlld1BvcnRDb250cm9sbGVyLmF1dG9tYXRlKF90aGlzLm92ZXJyaWRlQ29udGV4dCwgb3duaW5nVmlld19vcl9sYXlvdXRWaWV3KTtcclxuICAgICAgICAgICAgdmFyIHRyYW5zYWN0aW9uT3duZXJTaGlwVG9rZW4gPSBfdGhpcy5jb21wb3NpdGlvblRyYW5zYWN0aW9uT3duZXJzaGlwVG9rZW47XHJcbiAgICAgICAgICAgIC8vIGlmIHRoaXMgcm91dGVyLXZpZXcgaXMgdGhlIHJvb3QgPHJvdXRlci12aWV3Lz4gb2YgYSBub3JtYWwgc3RhcnR1cCB2aWEgYXVyZWxpYS5zZXRSb290XHJcbiAgICAgICAgICAgIC8vIGF0dGVtcCB0byB0YWtlIGNvbnRyb2wgb2YgdGhlIHRyYW5zYWN0aW9uXHJcbiAgICAgICAgICAgIC8vIGlmIG93bmVyc2hpcCBjYW4gYmUgdGFrZW5cclxuICAgICAgICAgICAgLy8gd2FpdCBmb3IgdHJhbnNhY3Rpb24gdG8gY29tcGxldGUgYmVmb3JlIHN3YXBwaW5nXHJcbiAgICAgICAgICAgIGlmICh0cmFuc2FjdGlvbk93bmVyU2hpcFRva2VuKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJhbnNhY3Rpb25Pd25lclNoaXBUb2tlblxyXG4gICAgICAgICAgICAgICAgICAgIC53YWl0Rm9yQ29tcG9zaXRpb25Db21wbGV0ZSgpXHJcbiAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIF90aGlzLmNvbXBvc2l0aW9uVHJhbnNhY3Rpb25Pd25lcnNoaXBUb2tlbiA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHdvcmsoKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC8vIG90aGVyd2lzZSwganVzdCBzd2FwXHJcbiAgICAgICAgICAgIHJldHVybiB3b3JrKCk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICAvLyBJZiB0aGVyZSBpcyBsYXlvdXQgaW5zdHJ1Y3Rpb24sIG5ldyB0byBjb21wb3NlIGxheW91dCBiZWZvcmUgcHJvY2Vzc2luZyBWaWV3UG9ydENvbXBvbmVudFxyXG4gICAgICAgIC8vIGxheW91dCBjb250cm9sbGVyL3ZpZXcvdmlldy1tb2RlbCBpcyBjb21wb3NlZCB1c2luZyBjb21wb3NpdGlvbiBlbmdpbmUgQVBJc1xyXG4gICAgICAgIGlmIChsYXlvdXRJbnN0cnVjdGlvbikge1xyXG4gICAgICAgICAgICBpZiAoIWxheW91dEluc3RydWN0aW9uLnZpZXdNb2RlbCkge1xyXG4gICAgICAgICAgICAgICAgLy8gY3JlYXRlQ29udHJvbGxlciBjaG9rZXMgaWYgdGhlcmUncyBubyB2aWV3bW9kZWwsIHNvIGNyZWF0ZSBhIGR1bW15IG9uZVxyXG4gICAgICAgICAgICAgICAgLy8gYnV0IGF2b2lkIHVzaW5nIGEgUE9KTyBhcyBpdCBjcmVhdGVzIHVud2FudGVkIG1ldGFkYXRhIGluIE9iamVjdCBjb25zdHJ1Y3RvclxyXG4gICAgICAgICAgICAgICAgbGF5b3V0SW5zdHJ1Y3Rpb24udmlld01vZGVsID0gbmV3IEVtcHR5TGF5b3V0Vmlld01vZGVsKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLy8gdXNpbmcgY29tcG9zaXRpb24gZW5naW5lIHRvIGNyZWF0ZSBjb21wb3NlIGxheW91dFxyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5jb21wb3NpdGlvbkVuZ2luZVxyXG4gICAgICAgICAgICAgICAgLy8gZmlyc3QgY3JlYXRlIGNvbnRyb2xsZXIgZnJvbSBsYXlvdXRJbnN0cnVjdGlvblxyXG4gICAgICAgICAgICAgICAgLy8gYW5kIHRyZWF0IGl0IGFzIENvbXBvc2l0aW9uQ29udGV4dFxyXG4gICAgICAgICAgICAgICAgLy8gdGhlbiBlbXVsYXRlIHNsb3QgcHJvamVjdGlvbiB3aXRoIFZpZXdQb3J0Q29tcG9uZW50IHZpZXdcclxuICAgICAgICAgICAgICAgIC5jcmVhdGVDb250cm9sbGVyKGxheW91dEluc3RydWN0aW9uKVxyXG4gICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKGxheW91dENvbnRyb2xsZXIpIHtcclxuICAgICAgICAgICAgICAgIHZhciBsYXlvdXRWaWV3ID0gbGF5b3V0Q29udHJvbGxlci52aWV3O1xyXG4gICAgICAgICAgICAgICAgU2hhZG93RE9NLmRpc3RyaWJ1dGVWaWV3KHZpZXdQb3J0Q29udHJvbGxlci52aWV3LCBsYXlvdXRDb250cm9sbGVyLnNsb3RzIHx8IGxheW91dFZpZXcuc2xvdHMpO1xyXG4gICAgICAgICAgICAgICAgLy8gd2hlbiB0aGVyZSBpcyBhIGxheW91dFxyXG4gICAgICAgICAgICAgICAgLy8gdmlldyBoaWVyYXJjaHkgaXM6IDxyb3V0ZXItdmlldy8+IG93bmVyIHZpZXcgLT4gbGF5b3V0IHZpZXcgLT4gVmlld1BvcnRDb21wb25lbnQgdmlld1xyXG4gICAgICAgICAgICAgICAgbGF5b3V0Q29udHJvbGxlci5hdXRvbWF0ZShjcmVhdGVPdmVycmlkZUNvbnRleHQobGF5b3V0SW5zdHJ1Y3Rpb24udmlld01vZGVsKSwgX3RoaXMub3duaW5nVmlldyk7XHJcbiAgICAgICAgICAgICAgICBsYXlvdXRWaWV3LmNoaWxkcmVuLnB1c2godmlld1BvcnRDb250cm9sbGVyLnZpZXcpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGxheW91dFZpZXcgfHwgbGF5b3V0Q29udHJvbGxlcjtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChuZXdWaWV3KSB7XHJcbiAgICAgICAgICAgICAgICBfdGhpcy52aWV3ID0gbmV3VmlldztcclxuICAgICAgICAgICAgICAgIHJldHVybiByZWFkeShuZXdWaWV3KTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIGlmIHRoZXJlIGlzIG5vIGxheW91dCwgdGhlbiBnZXQgVmlld1BvcnRDb21wb25lbnQgdmlldyByZWFkeSBhcyB2aWV3IHByb3BlcnR5XHJcbiAgICAgICAgLy8gYW5kIHByb2Nlc3MgY29udHJvbGxlci9zd2FwcGluZ1xyXG4gICAgICAgIC8vIHdoZW4gdGhlcmUgaXMgbm8gbGF5b3V0XHJcbiAgICAgICAgLy8gdmlldyBoaWVyYXJjaHkgaXM6IDxyb3V0ZXItdmlldy8+IG93bmVyIHZpZXcgLT4gVmlld1BvcnRDb21wb25lbnQgdmlld1xyXG4gICAgICAgIHRoaXMudmlldyA9IHZpZXdQb3J0Q29udHJvbGxlci52aWV3O1xyXG4gICAgICAgIHJldHVybiByZWFkeSh0aGlzLm93bmluZ1ZpZXcpO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogTm90aWZ5IGNvbXBvc2l0aW9uIHRyYW5zYWN0aW9uIHRoYXQgdGhpcyByb3V0ZXIgaGFzIGZpbmlzaGVkIHByb2Nlc3NpbmdcclxuICAgICAqIEhhcHBlbnMgd2hlbiB0aGlzIDxyb3V0ZXItdmlldy8+IGlzIHRoZSByb290IHJvdXRlci12aWV3XHJcbiAgICAgKiBAaW50ZXJuYWxcclxuICAgICAqL1xyXG4gICAgUm91dGVyVmlldy5wcm90b3R5cGUuX25vdGlmeSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgbm90aWZpZXIgPSB0aGlzLmNvbXBvc2l0aW9uVHJhbnNhY3Rpb25Ob3RpZmllcjtcclxuICAgICAgICBpZiAobm90aWZpZXIpIHtcclxuICAgICAgICAgICAgbm90aWZpZXIuZG9uZSgpO1xyXG4gICAgICAgICAgICB0aGlzLmNvbXBvc2l0aW9uVHJhbnNhY3Rpb25Ob3RpZmllciA9IG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogQGludGVybmFsIEFjdGl2ZWx5IGF2b2lkIHVzaW5nIGRlY29yYXRvciB0byByZWR1Y2UgdGhlIGFtb3VudCBvZiBjb2RlIGdlbmVyYXRlZFxyXG4gICAgICpcclxuICAgICAqIFRoZXJlIGlzIG5vIHZpZXcgdG8gY29tcG9zZSBieSBkZWZhdWx0IGluIGEgcm91dGVyIHZpZXdcclxuICAgICAqIFRoaXMgY3VzdG9tIGVsZW1lbnQgaXMgcmVzcG9uc2libGUgZm9yIGNvbXBvc2luZyBpdHMgb3duIHZpZXcsIGJhc2VkIG9uIGN1cnJlbnQgY29uZmlnXHJcbiAgICAgKi9cclxuICAgIFJvdXRlclZpZXcuJHZpZXcgPSBudWxsO1xyXG4gICAgLyoqXHJcbiAgICAgKiBAaW50ZXJuYWwgQWN0aXZlbHkgYXZvaWQgdXNpbmcgZGVjb3JhdG9yIHRvIHJlZHVjZSB0aGUgYW1vdW50IG9mIGNvZGUgZ2VuZXJhdGVkXHJcbiAgICAgKi9cclxuICAgIFJvdXRlclZpZXcuJHJlc291cmNlID0ge1xyXG4gICAgICAgIG5hbWU6ICdyb3V0ZXItdmlldycsXHJcbiAgICAgICAgYmluZGFibGVzOiBbJ3N3YXBPcmRlcicsICdsYXlvdXRWaWV3JywgJ2xheW91dFZpZXdNb2RlbCcsICdsYXlvdXRNb2RlbCcsICdpbmhlcml0LWJpbmRpbmctY29udGV4dCddXHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIFJvdXRlclZpZXc7XHJcbn0oKSk7XHJcbi8qKlxyXG4qIExvY2F0b3Igd2hpY2ggZmluZHMgdGhlIG5lYXJlc3QgUm91dGVyVmlldywgcmVsYXRpdmUgdG8gdGhlIGN1cnJlbnQgZGVwZW5kZW5jeSBpbmplY3Rpb24gY29udGFpbmVyLlxyXG4qL1xyXG52YXIgUm91dGVyVmlld0xvY2F0b3IgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICAvKipcclxuICAgICogQ3JlYXRlcyBhbiBpbnN0YW5jZSBvZiB0aGUgUm91dGVyVmlld0xvY2F0b3IgY2xhc3MuXHJcbiAgICAqL1xyXG4gICAgZnVuY3Rpb24gUm91dGVyVmlld0xvY2F0b3IoKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICB0aGlzLnByb21pc2UgPSBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSkgeyByZXR1cm4gX3RoaXMucmVzb2x2ZSA9IHJlc29sdmU7IH0pO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAqIEZpbmRzIHRoZSBuZWFyZXN0IFJvdXRlclZpZXcgaW5zdGFuY2UuXHJcbiAgICAqIEByZXR1cm5zIEEgcHJvbWlzZSB0aGF0IHdpbGwgYmUgcmVzb2x2ZWQgd2l0aCB0aGUgbG9jYXRlZCBSb3V0ZXJWaWV3IGluc3RhbmNlLlxyXG4gICAgKi9cclxuICAgIFJvdXRlclZpZXdMb2NhdG9yLnByb3RvdHlwZS5maW5kTmVhcmVzdCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5wcm9taXNlO1xyXG4gICAgfTtcclxuICAgIC8qKkBpbnRlcm5hbCAqL1xyXG4gICAgUm91dGVyVmlld0xvY2F0b3IucHJvdG90eXBlLl9ub3RpZnkgPSBmdW5jdGlvbiAocm91dGVyVmlldykge1xyXG4gICAgICAgIHRoaXMucmVzb2x2ZShyb3V0ZXJWaWV3KTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gUm91dGVyVmlld0xvY2F0b3I7XHJcbn0oKSk7XG5cbi8qKkBpbnRlcm5hbCBleHBvcnRlZCBmb3IgdW5pdCB0ZXN0aW5nICovXHJcbnZhciBFbXB0eUNsYXNzID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gRW1wdHlDbGFzcygpIHtcclxuICAgIH1cclxuICAgIHJldHVybiBFbXB0eUNsYXNzO1xyXG59KCkpO1xyXG5pbmxpbmVWaWV3KCc8dGVtcGxhdGU+PC90ZW1wbGF0ZT4nKShFbXB0eUNsYXNzKTtcclxuLyoqXHJcbiAqIERlZmF1bHQgaW1wbGVtZW50YXRpb24gb2YgYFJvdXRlTG9hZGVyYCB1c2VkIGZvciBsb2FkaW5nIGNvbXBvbmVudCBiYXNlZCBvbiBhIHJvdXRlIGNvbmZpZ1xyXG4gKi9cclxudmFyIFRlbXBsYXRpbmdSb3V0ZUxvYWRlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcclxuICAgIF9fZXh0ZW5kcyhUZW1wbGF0aW5nUm91dGVMb2FkZXIsIF9zdXBlcik7XHJcbiAgICBmdW5jdGlvbiBUZW1wbGF0aW5nUm91dGVMb2FkZXIoY29tcG9zaXRpb25FbmdpbmUpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzKSB8fCB0aGlzO1xyXG4gICAgICAgIF90aGlzLmNvbXBvc2l0aW9uRW5naW5lID0gY29tcG9zaXRpb25FbmdpbmU7XHJcbiAgICAgICAgcmV0dXJuIF90aGlzO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBSZXNvbHZlIGEgdmlldyBtb2RlbCBmcm9tIGEgUm91dGVDb25maWdcclxuICAgICAqIFRocm93cyB3aGVuIHRoZXJlIGlzIG5laXRoZXIgXCJtb2R1bGVJZFwiIG5vciBcInZpZXdNb2RlbFwiIHByb3BlcnR5XHJcbiAgICAgKiBAaW50ZXJuYWxcclxuICAgICAqL1xyXG4gICAgVGVtcGxhdGluZ1JvdXRlTG9hZGVyLnByb3RvdHlwZS5yZXNvbHZlVmlld01vZGVsID0gZnVuY3Rpb24gKHJvdXRlciwgY29uZmlnKSB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcclxuICAgICAgICAgICAgdmFyIHZpZXdNb2RlbDtcclxuICAgICAgICAgICAgaWYgKCdtb2R1bGVJZCcgaW4gY29uZmlnKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgbW9kdWxlSWQgPSBjb25maWcubW9kdWxlSWQ7XHJcbiAgICAgICAgICAgICAgICBpZiAobW9kdWxlSWQgPT09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgICAgICB2aWV3TW9kZWwgPSBFbXB0eUNsYXNzO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gdGhpcyByZXF1aXJlcyBjb250YWluZXIgb2Ygcm91dGVyIGhhcyBwYXNzZXMgYSBjZXJ0YWluIHBvaW50XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gd2hlcmUgYSB2aWV3IG1vZGVsIGhhcyBiZWVuIHNldHVwIG9uIHRoZSBjb250YWluZXJcclxuICAgICAgICAgICAgICAgICAgICAvLyBpdCB3aWxsIGZhaWwgaW4gZW5oYW5jZSBzY2VuYXJpbyBiZWNhdXNlIG5vIHZpZXdwb3J0IGhhcyBiZWVuIHJlZ2lzdGVyZWRcclxuICAgICAgICAgICAgICAgICAgICBtb2R1bGVJZCA9IHJlbGF0aXZlVG9GaWxlKG1vZHVsZUlkLCBPcmlnaW4uZ2V0KHJvdXRlci5jb250YWluZXIudmlld01vZGVsLmNvbnN0cnVjdG9yKS5tb2R1bGVJZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKC9cXC5odG1sL2kudGVzdChtb2R1bGVJZCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmlld01vZGVsID0gY3JlYXRlRHluYW1pY0NsYXNzKG1vZHVsZUlkKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZpZXdNb2RlbCA9IG1vZHVsZUlkO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiByZXNvbHZlKHZpZXdNb2RlbCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLy8gdG9kbzogYWRkIGlmICgndmlld01vZGVsJyBpbiBjb25maWcpIHRvIHN1cHBvcnQgc3RhdGljIHZpZXcgbW9kZWwgcmVzb2x1dGlvblxyXG4gICAgICAgICAgICByZWplY3QobmV3IEVycm9yKCdJbnZhbGlkIHJvdXRlIGNvbmZpZy4gTm8gXCJtb2R1bGVJZFwiIGZvdW5kLicpKTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIENyZWF0ZSBjaGlsZCBjb250YWluZXIgYmFzZWQgb24gYSByb3V0ZXIgY29udGFpbmVyXHJcbiAgICAgKiBBbHNvIGVuc3VyZXMgdGhhdCBjaGlsZCByb3V0ZXIgYXJlIHByb3Blcmx5IGNvbnN0cnVjdGVkIGluIHRoZSBuZXdseSBjcmVhdGVkIGNoaWxkIGNvbnRhaW5lclxyXG4gICAgICogQGludGVybmFsXHJcbiAgICAgKi9cclxuICAgIFRlbXBsYXRpbmdSb3V0ZUxvYWRlci5wcm90b3R5cGUuY3JlYXRlQ2hpbGRDb250YWluZXIgPSBmdW5jdGlvbiAocm91dGVyKSB7XHJcbiAgICAgICAgdmFyIGNoaWxkQ29udGFpbmVyID0gcm91dGVyLmNvbnRhaW5lci5jcmVhdGVDaGlsZCgpO1xyXG4gICAgICAgIGNoaWxkQ29udGFpbmVyLnJlZ2lzdGVyU2luZ2xldG9uKFJvdXRlclZpZXdMb2NhdG9yKTtcclxuICAgICAgICBjaGlsZENvbnRhaW5lci5nZXRDaGlsZFJvdXRlciA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIGNoaWxkUm91dGVyO1xyXG4gICAgICAgICAgICBjaGlsZENvbnRhaW5lci5yZWdpc3RlckhhbmRsZXIoUm91dGVyLCBmdW5jdGlvbiAoKSB7IHJldHVybiBjaGlsZFJvdXRlciB8fCAoY2hpbGRSb3V0ZXIgPSByb3V0ZXIuY3JlYXRlQ2hpbGQoY2hpbGRDb250YWluZXIpKTsgfSk7XHJcbiAgICAgICAgICAgIHJldHVybiBjaGlsZENvbnRhaW5lci5nZXQoUm91dGVyKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHJldHVybiBjaGlsZENvbnRhaW5lcjtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIExvYWQgY29ycmVzcG9uZGluZyBjb21wb25lbnQgb2YgYSByb3V0ZSBjb25maWcgb2YgYSBuYXZpZ2F0aW9uIGluc3RydWN0aW9uXHJcbiAgICAgKi9cclxuICAgIFRlbXBsYXRpbmdSb3V0ZUxvYWRlci5wcm90b3R5cGUubG9hZFJvdXRlID0gZnVuY3Rpb24gKHJvdXRlciwgY29uZmlnLCBfbmF2SW5zdHJ1Y3Rpb24pIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHJldHVybiB0aGlzXHJcbiAgICAgICAgICAgIC5yZXNvbHZlVmlld01vZGVsKHJvdXRlciwgY29uZmlnKVxyXG4gICAgICAgICAgICAudGhlbihmdW5jdGlvbiAodmlld01vZGVsKSB7IHJldHVybiBfdGhpcy5jb21wb3NpdGlvbkVuZ2luZS5lbnN1cmVWaWV3TW9kZWwoe1xyXG4gICAgICAgICAgICB2aWV3TW9kZWw6IHZpZXdNb2RlbCxcclxuICAgICAgICAgICAgY2hpbGRDb250YWluZXI6IF90aGlzLmNyZWF0ZUNoaWxkQ29udGFpbmVyKHJvdXRlciksXHJcbiAgICAgICAgICAgIHZpZXc6IGNvbmZpZy52aWV3IHx8IGNvbmZpZy52aWV3U3RyYXRlZ3ksXHJcbiAgICAgICAgICAgIHJvdXRlcjogcm91dGVyXHJcbiAgICAgICAgfSk7IH0pO1xyXG4gICAgfTtcclxuICAgIC8qKkBpbnRlcm5hbCAqL1xyXG4gICAgVGVtcGxhdGluZ1JvdXRlTG9hZGVyLmluamVjdCA9IFtDb21wb3NpdGlvbkVuZ2luZV07XHJcbiAgICByZXR1cm4gVGVtcGxhdGluZ1JvdXRlTG9hZGVyO1xyXG59KFJvdXRlTG9hZGVyKSk7XHJcbi8qKkBpbnRlcm5hbCBleHBvcnRlZCBmb3IgdW5pdCB0ZXN0aW5nICovXHJcbmZ1bmN0aW9uIGNyZWF0ZUR5bmFtaWNDbGFzcyhtb2R1bGVJZCkge1xyXG4gICAgdmFyIG5hbWUgPSAvKFteXFwvXlxcP10rKVxcLmh0bWwvaS5leGVjKG1vZHVsZUlkKVsxXTtcclxuICAgIHZhciBEeW5hbWljQ2xhc3MgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgZnVuY3Rpb24gRHluYW1pY0NsYXNzKCkge1xyXG4gICAgICAgIH1cclxuICAgICAgICBEeW5hbWljQ2xhc3MucHJvdG90eXBlLmJpbmQgPSBmdW5jdGlvbiAoYmluZGluZ0NvbnRleHQpIHtcclxuICAgICAgICAgICAgdGhpcy4kcGFyZW50ID0gYmluZGluZ0NvbnRleHQ7XHJcbiAgICAgICAgfTtcclxuICAgICAgICByZXR1cm4gRHluYW1pY0NsYXNzO1xyXG4gICAgfSgpKTtcclxuICAgIGN1c3RvbUVsZW1lbnQobmFtZSkoRHluYW1pY0NsYXNzKTtcclxuICAgIHVzZVZpZXcobW9kdWxlSWQpKER5bmFtaWNDbGFzcyk7XHJcbiAgICByZXR1cm4gRHluYW1pY0NsYXNzO1xyXG59XG5cbnZhciBsb2dnZXIgPSBnZXRMb2dnZXIoJ3JvdXRlLWhyZWYnKTtcclxuLyoqXHJcbiAqIEhlbHBlciBjdXN0b20gYXR0cmlidXRlIHRvIGhlbHAgYXNzb2NpYXRlIGFuIGVsZW1lbnQgd2l0aCBhIHJvdXRlIGJ5IG5hbWVcclxuICovXHJcbnZhciBSb3V0ZUhyZWYgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBSb3V0ZUhyZWYocm91dGVyLCBlbGVtZW50KSB7XHJcbiAgICAgICAgdGhpcy5yb3V0ZXIgPSByb3V0ZXI7XHJcbiAgICAgICAgdGhpcy5lbGVtZW50ID0gZWxlbWVudDtcclxuICAgICAgICB0aGlzLmF0dHJpYnV0ZSA9ICdocmVmJztcclxuICAgIH1cclxuICAgIC8qQGludGVybmFsICovXHJcbiAgICBSb3V0ZUhyZWYuaW5qZWN0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiBbUm91dGVyLCBET00uRWxlbWVudF07XHJcbiAgICB9O1xyXG4gICAgUm91dGVIcmVmLnByb3RvdHlwZS5iaW5kID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHRoaXMuaXNBY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgIHRoaXMucHJvY2Vzc0NoYW5nZSgpO1xyXG4gICAgfTtcclxuICAgIFJvdXRlSHJlZi5wcm90b3R5cGUudW5iaW5kID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHRoaXMuaXNBY3RpdmUgPSBmYWxzZTtcclxuICAgIH07XHJcbiAgICBSb3V0ZUhyZWYucHJvdG90eXBlLmF0dHJpYnV0ZUNoYW5nZWQgPSBmdW5jdGlvbiAodmFsdWUsIHByZXZpb3VzKSB7XHJcbiAgICAgICAgaWYgKHByZXZpb3VzKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZWxlbWVudC5yZW1vdmVBdHRyaWJ1dGUocHJldmlvdXMpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdGhpcy5wcm9jZXNzQ2hhbmdlKCk7XHJcbiAgICB9O1xyXG4gICAgUm91dGVIcmVmLnByb3RvdHlwZS5wcm9jZXNzQ2hhbmdlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMucm91dGVyXHJcbiAgICAgICAgICAgIC5lbnN1cmVDb25maWd1cmVkKClcclxuICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBpZiAoIV90aGlzLmlzQWN0aXZlKSB7XHJcbiAgICAgICAgICAgICAgICAvLyByZXR1cm5pbmcgbnVsbCB0byBhdm9pZCBCbHVlYmlyZCB3YXJuaW5nXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB2YXIgZWxlbWVudCA9IF90aGlzLmVsZW1lbnQ7XHJcbiAgICAgICAgICAgIHZhciBocmVmID0gX3RoaXMucm91dGVyLmdlbmVyYXRlKF90aGlzLnJvdXRlLCBfdGhpcy5wYXJhbXMpO1xyXG4gICAgICAgICAgICBpZiAoZWxlbWVudC5hdS5jb250cm9sbGVyKSB7XHJcbiAgICAgICAgICAgICAgICBlbGVtZW50LmF1LmNvbnRyb2xsZXIudmlld01vZGVsW190aGlzLmF0dHJpYnV0ZV0gPSBocmVmO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgZWxlbWVudC5zZXRBdHRyaWJ1dGUoX3RoaXMuYXR0cmlidXRlLCBocmVmKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvLyByZXR1cm5pbmcgbnVsbCB0byBhdm9pZCBCbHVlYmlyZCB3YXJuaW5nXHJcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgICAgIC5jYXRjaChmdW5jdGlvbiAocmVhc29uKSB7XHJcbiAgICAgICAgICAgIGxvZ2dlci5lcnJvcihyZWFzb24pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogQGludGVybmFsIEFjdGl2ZWx5IGF2b2lkIHVzaW5nIGRlY29yYXRvciB0byByZWR1Y2UgdGhlIGFtb3VudCBvZiBjb2RlIGdlbmVyYXRlZFxyXG4gICAgICovXHJcbiAgICBSb3V0ZUhyZWYuJHJlc291cmNlID0ge1xyXG4gICAgICAgIHR5cGU6ICdhdHRyaWJ1dGUnLFxyXG4gICAgICAgIG5hbWU6ICdyb3V0ZS1ocmVmJyxcclxuICAgICAgICBiaW5kYWJsZXM6IFtcclxuICAgICAgICAgICAgeyBuYW1lOiAncm91dGUnLCBjaGFuZ2VIYW5kbGVyOiAncHJvY2Vzc0NoYW5nZScsIHByaW1hcnlQcm9wZXJ0eTogdHJ1ZSB9LFxyXG4gICAgICAgICAgICB7IG5hbWU6ICdwYXJhbXMnLCBjaGFuZ2VIYW5kbGVyOiAncHJvY2Vzc0NoYW5nZScgfSxcclxuICAgICAgICAgICAgJ2F0dHJpYnV0ZSdcclxuICAgICAgICBdIC8vIHR5cGUgZGVmaW5pdGlvbiBvZiBBdXJlbGlhIHRlbXBsYXRpbmcgaXMgd3JvbmdcclxuICAgIH07XHJcbiAgICByZXR1cm4gUm91dGVIcmVmO1xyXG59KCkpO1xuXG5mdW5jdGlvbiBjb25maWd1cmUoY29uZmlnKSB7XHJcbiAgICBjb25maWdcclxuICAgICAgICAuc2luZ2xldG9uKFJvdXRlTG9hZGVyLCBUZW1wbGF0aW5nUm91dGVMb2FkZXIpXHJcbiAgICAgICAgLnNpbmdsZXRvbihSb3V0ZXIsIEFwcFJvdXRlcilcclxuICAgICAgICAuZ2xvYmFsUmVzb3VyY2VzKFJvdXRlclZpZXcsIFJvdXRlSHJlZik7XHJcbiAgICBjb25maWcuY29udGFpbmVyLnJlZ2lzdGVyQWxpYXMoUm91dGVyLCBBcHBSb3V0ZXIpO1xyXG59XG5cbmV4cG9ydCB7IFJvdXRlSHJlZiwgUm91dGVyVmlldywgVGVtcGxhdGluZ1JvdXRlTG9hZGVyLCBjb25maWd1cmUgfTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWF1cmVsaWEtdGVtcGxhdGluZy1yb3V0ZXIuanMubWFwXG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0EiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///aurelia-templating-router\n");

/***/ })

}]);